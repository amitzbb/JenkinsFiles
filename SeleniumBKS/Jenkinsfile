pipeline {
    agent { node { label 'Dev-CI01' } }
    parameters {
       string (name: 'Images' , defaultValue :'D:\\WorkSpace\\Fox8\\Dev\\FoxTestingFrameworkDev\\images' ,description: 'Paramter') 
    }
     stages {
            stage ('Compiling New Optimization Engine') {
            steps {
                powershell '''$path = "C:\\Users\\master\\Perforce\\dba_DEV-CI01_182\\Fox8\\Dev\\Optimization\\SchedulerEngine\\UnitTests\\bin"
                              Get-ChildItem $Path | Where{$_.Name -Match "20"} | Remove-Item -force -Recurse'''
                bat '''C:\\nuget\\nuget.exe restore "C:\\Users\\master\\Perforce\\dba_DEV-CI01_182\\Fox8\\Dev\\Optimization\\SchedulerEngine\\SchedulerEngine.sln"
                        "C:\\Program Files (x86)\\MSBuild\\14.0\\Bin\\MSBuild.exe"  "C:\\Users\\master\\Perforce\\dba_DEV-CI01_182\\Fox8\\Dev\\Optimization\\SchedulerEngine\\SchedulerEngine.sln" /t:Clean /verbosity:minimal
                        "C:\\Program Files (x86)\\MSBuild\\14.0\\Bin\\MSBuild.exe"  "C:\\Users\\master\\Perforce\\dba_DEV-CI01_182\\Fox8\\Dev\\Optimization\\SchedulerEngine\\SchedulerEngine.sln" /p:Configuration=Release /p:DebugSymbols=false /p:DebugType=None /verbosity:minimal /clp:parameters:Summary'''
                
                bat '''C:\\nuget\\nuget.exe restore "C:\\Users\\master\\Perforce\\dba_DEV-CI01_182\\Fox8\\Dev\\Optimization\\OptimizationService\\OptimizationService.sln"
                        "C:\\Program Files (x86)\\MSBuild\\14.0\\Bin\\MSBuild.exe"  "C:\\Users\\master\\Perforce\\dba_DEV-CI01_182\\Fox8\\Dev\\Optimization\\OptimizationService\\OptimizationService.sln" /t:Clean /verbosity:minimal
                        "C:\\Program Files (x86)\\MSBuild\\14.0\\Bin\\MSBuild.exe"  "C:\\Users\\master\\Perforce\\dba_DEV-CI01_182\\Fox8\\Dev\\Optimization\\OptimizationService\\OptimizationService.sln" /p:Configuration=Release /p:DebugSymbols=false /p:DebugType=None /verbosity:minimal /clp:parameters:Summary'''
                bat '''C:\\nuget\\nuget.exe restore "C:\\Users\\master\\Perforce\\dba_DEV-CI01_182\\Fox8\\Dev\\Optimization\\FoxOptimizationHandlers\\FoxOptimizationHandlers.sln"
                        "C:\\Program Files (x86)\\MSBuild\\14.0\\Bin\\MSBuild.exe"  "C:\\Users\\master\\Perforce\\dba_DEV-CI01_182\\Fox8\\Dev\\Optimization\\FoxOptimizationHandlers\\FoxOptimizationHandlers.sln" /t:Clean /verbosity:minimal
                        "C:\\Program Files (x86)\\MSBuild\\14.0\\Bin\\MSBuild.exe"  "C:\\Users\\master\\Perforce\\dba_DEV-CI01_182\\Fox8\\Dev\\Optimization\\FoxOptimizationHandlers\\FoxOptimizationHandlers.sln" /p:Configuration=Release /p:DebugSymbols=false /p:DebugType=None /verbosity:minimal /clp:parameters:Summary'''
               bat 'C:\\Dev-CI01\\NewEngine\\NewEngineConfig.exe'   
            }
        }
     }
     post {
         failure {
            emailext body: '''$DEFAULT_CONTENT
                            The site can be reached at:
                            http://dev-pilot.bks/Login.aspx''', subject: 'Dev-Pilot Unit Tests status', to: 'amitbl@britannica-ks.com'
        }
    }
} 
