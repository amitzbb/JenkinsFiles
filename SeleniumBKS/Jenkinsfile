pipeline {
    agent { node { label 'Dev-CI01' } }
    parameters {
       string (name: 'Images' , defaultValue :'D:\\WorkSpace\\Fox8\\Dev\\FoxTestingFrameworkDev\\images' ,description: 'Paramter') 
    }
     stages {
        stage('BksInstaller') {
            steps {
                bat '''cd C:\\Users\\master\\Perforce\\dba_DEV-CI01_182\\Fox8\\Dev\\Code\\FoxApp npm cache verify'''
                        powershell '''$package = "C:\\Users\\master\\Perforce\\dba_DEV-CI01_182\\Fox8\\Dev\\Code\\FoxApp\\package.json"
                                      $Config = "C:\\Users\\master\\Perforce\\dba_DEV-CI01_182\\Fox8\\Dev\\Code\\FoxApp\\config.xml"
                                        Set-ItemProperty $package -name IsReadOnly -value $false
                                        Set-ItemProperty $Config -name IsReadOnly -value $false
                                        Write-host "npm install"
                                        cd C:\\Users\\master\\Perforce\\dba_DEV-CI01_182\\Fox8\\Dev\\Code\\FoxApp npm install'''
                        bat '''cd C:\\Users\\master\\Perforce\\dba_DEV-CI01_182\\Fox8\\Dev\\Code\\FoxApp npm run ionic:build'''
                        bat '''Robocopy /mir C:\\Users\\master\\Perforce\\dba_DEV-CI01_182\\Fox8\\Dev\\Code\\FoxApp\\www\\ C:\\inetpub\\wwwroot\\FoxApp
                                xcopy "\\\\bks-fs\\FoxDATA$_0\\dev-pilotCI-Config\\FoxApp\\customSettings.json" "C:\\inetpub\\wwwroot\\FoxApp\\assets\\custom-config" /Y/r'''
                        bat 'C:\\Dev-CI01\\FoxNGAPI\\FoxNGAPI.exe'
            }
        }
     }
     post {
         failure {
            emailext body: '''$DEFAULT_CONTENT
                            The site can be reached at:
                            http://dev-pilot.bks/Login.aspx''', subject: 'Dev-Pilot Unit Tests status', to: 'amitbl@britannica-ks.com'
        }
    }
} 
